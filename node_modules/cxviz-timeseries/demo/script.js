'use strict';

// Dependencies

var Graph   = require('../index.js')
var data    = require('./sample-data.json')
var sdData  = require('./trans-sample.json')
var sdData2 = require('./trans-sample.json')
var numeral = require('numeral')

function mbFormat(val){
  return numeral(val).format('0.0 b')
}

var colormap = {
  'Process Heap Total': '#379f15',
  'Process Heap Used': '#fe6600',
  'Process RSS': '#1862b5',
  'Transaction time stddev': 'purple',
  'Transaction time min\/max': 'black'
}

function color(name){
  return colormap[name] || '#00ff00'
}

var el = document.getElementById('timeseries-cont')

var graphOptions = {
  yMin: 0,
  color: color,
  format: {
    'y': 'mb'
  }
}

var graph = Graph(el, graphOptions)

graph.draw(data)

var sdel = document.getElementById('stddev-cont')

var sdOptions = {
  yMin: 0,
  color: color,
  formatter: mbFormat,
  format: {
    'y': 'ms',
    'y1': 'num'
  },
  keySchema: {
    'Transaction time stddev': {
      class: 'cxviz-timeseries-stddev'
    },
    'Transaction time min\/max':{
      class: 'cxviz-timeseries-minmax'
    },
    'Number of calls': {
      y: 'y1'
    }
  }
}

var sdGraph = Graph(sdel, sdOptions)

sdGraph.draw(sdData)

var sdel2 = document.getElementById('stddev-cont2')

var sdOptions2 = {
  yMin: 0,
  color: color,
  formatter: mbFormat,
  format: {
    'y': 'ms',
    'y1': 'num'
  },
  keySchema: {
    'Transaction time stddev': {
      class: 'cxviz-timeseries-stddev',
      type: 'rect'
    },
    'Transaction time min\/max':{
      class: 'cxviz-timeseries-minmax',
      type: 'range'
    },
    'Number of calls': {
      y: 'y1'
    }
  }
}
var sdGraph2 = Graph(sdel2, sdOptions2)
sdGraph2.draw(sdData2)

window.onresize = function resize(e){
  console.log('got resize event', e)
  // graph.resize()
  // sdGraph.resize()
}
